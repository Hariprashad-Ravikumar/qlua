LAT = qcd.lattice{7, 8}

print("lattice:", LAT)
for i = 0, #LAT - 1 do
  print("dim[" .. i .. "] = " .. LAT[i])
end

c0 = LAT:pcoord(0)
c1 = LAT:pcoord(1)

print("pcoord(2)", c0)
print("type(c0)", type(c0))

c0[{1,2}] = -1

cx = c0 + 100 * c1
cy = LAT:pcoord(0):shift(0, "from_backward")
cz = LAT:pcoord(1):shift(1, "from_forward")
for d0 = 0, 7 - 1 do 
  for d1 = 0, 8 - 1 do
    print("  ", d0, d1,
          cy[{d0, d1}],
          cz[{d0, d1}],
          cx[{d0, d1}],
          cx[{d0,d1}]==(c0[{d0,d1}]+100*c1[{d0,d1}]))
    if not (cx[{d0,d1}] == (c0[{d0,d1}]+100*c1[{d0,d1}])) then
       error("**** disagreement")
    end
  end
end

cz = LAT:Int(cx)
print("sum(pcoord(0))", LAT:pcoord(0):sum())
print("sum(pcoord(1))", LAT:pcoord(1):sum())

print("s2 is", LAT:Int(2):norm2() == 7 * 8 * 4)

print("\nVersions:")
for i, v in pairs(qcd.version) do
  print("   " .. i .. " :  " .. v)
end
